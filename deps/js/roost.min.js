window._roost||(window._roost=[]),_roost.init||!function(e){function c(e){if(!e||!e.origin)return;if(l.indexOf(e.origin)==-1)return;var t=JSON.parse(e.data);if(t.type&&t.type=="registered"){_roost._fireRoostCallback({firstTime:t.firstTime,deviceToken:t.deviceToken,registered:t.enabled,enabled:!0,tags:t.tags,alias:t.alias});return}u.enabled=t.enabled,u.tags=t.tags,u.alias=t.alias,u.websiteDomain=t.websiteDomain;for(var n=0;n<_roost.length;n++)f.push(_roost[n]);_roost=f,_roost._o=u;var r=u.onload;r&&typeof r=="function"&&r({promptable:_roost.promptable()}),u.initFunction&&u.initFunction(!0)}function h(){u.appkey="1614486d7a974efa8f15823a92ce6bd3",v(),E("experimental"),u.appkey!="DEMO"&&(window&&typeof window.safari!="undefined"?(u.initFunction=D,u.idFunction=_):u.experimental&&o&&(u.initFunction=P)),u.initFunction&&(f.prompt=function(){u.initFunction(!1)}),u.idFunction&&(u.rdt=u.idFunction()),u.rdt||(u.rdt=L("_rdt")),u.rid=L("_rid"),(!u.rid||u.rid=="")&&S()&&(u.rid=g(),k("_rid",u.rid)),E("host");if(u.initFunction){var e=u.host+"/api/pageview?rdt="+encodeURIComponent(u.rdt)+"&rid="+encodeURIComponent(u.rid)+"&appKey="+encodeURIComponent(u.appkey)+"&url="+encodeURIComponent(document.URL)+"&referrer="+encodeURIComponent(document.referrer);p(e)}else{var t=u.onload;t&&typeof t=="function"&&t({promptable:f.promptable()})}}function p(e){var t=document.createElement("iframe");t.style.display="none",t.src=e,document.body.appendChild(t)}function d(e){var t=document.createElement("iframe");t.style.display="none";var n=!1;t.onload=function(){n=!0},setTimeout(function(){n||console.log("Roost Error: Could not load required content: "+e)},2e3),t.src=e,document.body.appendChild(t)}function v(){typeof twttr!="undefined"&&typeof twttr.events!="undefined"&&typeof twttr.events.bind!="undefined"&&twttr.events.bind("tweet",function(e){f.push(["social_action","TWEET"])}),typeof FB!="undefined"&&typeof FB.Event!="undefined"&&typeof FB.Event.subscribe!="undefined"&&(FB.Event.subscribe("edge.create",function(e){f.push(["social_action","FB_LIKE"])}),FB.Event.subscribe("edge.remove",function(e){f.push(["social_action","FB_UNLIKE"])}),FB.Event.subscribe("comment.create",function(e){f.push(["social_action","FB_COMMENT"])}),FB.Event.subscribe("comment.remove",function(e){f.push(["social_action","FB_UNCOMMENT"])}),FB.Event.subscribe("message.send",function(e){f.push(["social_action","FB_SHARE"])}))}function m(){return location.protocol=="https:"}function g(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function E(e){var t=[];for(var n=0;n<_roost.length;n++)_roost[n].length&&_roost[n][0]==e?f.push(_roost[n]):t.push(_roost[n]);_roost=t}function S(){var e="cc"+Math.random(),t=!1;return k(e,"true"),L(e)&&(t=!0),k(e,"",-1),t}function x(t){T({url:u.host+"/Ping",vars:{appKey:u.appkey,referrer:encodeURIComponent((document.referrer+"").split("'").join("%27")),page:encodeURIComponent((e.location+"").split("'").join("%27")),action:"log",details:t?JSON.stringify(t):"",rdt:L("_rdt")}})}function T(e){e=e||{},e.url=e.url||null,e.vars=e.vars||{},e.error=e.error||function(){},e.success=e.success||function(){};var t=[];for(var n in e.vars)t.push(n+"="+encodeURIComponent(e.vars[n]));var r=t.join("&");if(e.url){var i=e.url+"?"+r,s=new Image;e.error&&(s.onerror=e.error),e.success&&(s.onload=e.success),s.src=i}}function N(e){u[e[0]]=typeof e[1]=="undefined"?u[e[0]]:e[1]}function C(e){return function(t){if(!u.appkey)return!1;e(t)}}function k(e,t,n,r){n||(n=0);var i=new Date;i.setTime(i.getTime()+n*24*60*60*1e3);var s=escape(t)+(n==null||n==0?"":"; expires="+i.toGMTString())+"; "+(r?" domain=."+r+"; ":"")+" path=/";document.cookie=e+"="+s}function L(e){if(document.cookie.length>0){c_start=document.cookie.indexOf(e+"=");if(c_start!=-1)return c_start=c_start+e.length+1,c_end=document.cookie.indexOf(";",c_start),c_end==-1&&(c_end=document.cookie.length),unescape(document.cookie.substring(c_start,c_end))}return""}function _(){var e="web.web.me.roost.autob473dc7f18e0491da8b5d3f1d1d6e576",t=window.safari.pushNotification.permission(e);if(t.permission=="granted")return t.deviceToken}function D(e){typeof e=="undefined"&&(e=!1);var t="web.web.me.roost.autob473dc7f18e0491da8b5d3f1d1d6e576",n=!1,r=location.host,i=location.host.split(".").reverse();i.length>1&&r.indexOf("blogger.com")==-1&&(r=i[1]+"."+i[0]),r=r.split(":")[0];var s=function(){n=!0;var e=_roost._getTags(),i=_roost._getAlias();A=setInterval(function(){var e=window.safari.pushNotification.permission(t);e.permission=="granted"&&!O&&(O=!0,console.log("Fake callback"),_roost._fireRoostCallback({firstTime:!0,deviceToken:e.deviceToken,registered:e.permission!="denied",enabled:!0,tags:_roost._getTags(),alias:_roost._getAlias()}),_roost.setCookie("_rdt",e.deviceToken,1825,r)),O&&clearInterval(A)},1e3),window.safari.pushNotification.requestPermission("https://go.goroost.com/register/native/safari/1614486d7a974efa8f15823a92ce6bd3",t,{website:encodeURIComponent(location.href),data:"{'tags':'"+e+"','alias':'"+i+"'}"},M)},o=window.safari.pushNotification.permission(t);if(o.permission=="default"){var u=_roost._isAutoPrompt(),a=_roost._promptMinVisits();(!e||u||a)&&s()}else o.permission=="granted"?(_roost._fireRoostCallback({firstTime:!1,deviceToken:o.deviceToken,registered:!0,enabled:_roost._isEnabled(),tags:_roost._getTags(),alias:_roost._getAlias()}),o.deviceToken&&_roost.setCookie("_rdt",o.deviceToken,1825,r)):_roost._fireRoostCallback({firstTime:!1,deviceToken:o.deviceToken,registered:!1,enabled:_roost._isEnabled(),tags:_roost._getTags(),alias:_roost._getAlias()})}function P(e){typeof e=="undefined"&&(e=!1),document.domain!=u.websiteDomain&&console.log("Roost Error: Domains do not match and Chrome push can old support a single config / domain: "+u.websiteDomain);var t=_roost._getTags(),n=_roost._getAlias(),r="?appKey="+u.appkey+"&host="+encodeURIComponent(u.host);n&&(r+="&alias="+encodeURIComponent(n));for(var i=0;i<t.length;i++){var s=t[i];r+="&tag="+encodeURIComponent(s)}var o;if(u.host.indexOf("localhost")!=-1&&location.protocol!=="https:"){console.log("Roost Error: Chrome requires the page to be SSL or localhost to support push.");return}o="/roost.html",o+=r,d(o)}function H(){document.readyState==="interactive"||document.readyState==="complete"?h():document.addEventListener?window.addEventListener("load",h):document.attachEvent("onload",h)}var t=!!window.PushManager||!!navigator.push,n=!!window.Notification,r=!!navigator.serviceWorker,i=window.chrome,s=window.navigator.vendor;i!==null&&i!==undefined&&s==="Google Inc."?i=!0:i=!1;var o=i&&t&&n&&r,u={autoprompt:!0,appkey:null,experimental:!1,host:"https://go.goroost.com",rdt:"none",rid:null,tags:null,alias:null,enabled:!0,initFunction:null,idFunction:null,websiteDomain:null},a=[],f={init:!0,push:function(){for(var t=0;t<arguments.length;t++){var n=arguments[t];n&&n.length&&w[""+n[0].toLowerCase()]?w[n[0].toLowerCase()](n):e.console.log("Invalid command '"+n+"'.")}},getCookie:L,setCookie:k,promptable:function(){return typeof window.safari!="undefined"&&typeof window.safari.pushNotification!="undefined"?!0:o?!0:!1},prompt:function(){},_fireRoostCallback:function(e){window._roostCallback&&typeof window._roostCallback=="function"&&window._roostCallback(e),u.onresult&&typeof u.onresult=="function"&&u.onresult(e)},_isAutoPrompt:function(){return u.autoprompt},_isEnabled:function(){return u.enabled},_getTags:function(){return u.tags},_getAlias:function(){return u.alias},_getRID:function(){return u.rid},_domain:function(){var e=location.host,t=location.host.split(".").reverse();return t.length>1&&e.indexOf("blogger.com")==-1&&(e=t[1]+"."+t[0]),e=e.split(":")[0],e},_cookiesEnabled:function(){var e="cc"+Math.random(),t=!1;return _roost.setCookie(e,"true"),_roost.getCookie(e)&&(t=!0),_roost.setCookie(e,"",-1),t},_promptMinVisits:function(){if(u.minvisits>-1){if(!_roost._cookiesEnabled())return!1;var e="_r_visits",t=_roost.getCookie(e);return t?t++:t=1,_roost.setCookie(e,t,30,_roost._domain()),u.minvisits<=t}return!1},_enqueue:function(e){a.push(e),a.length==1&&f._processQueue()},_processQueue:function(){if(a.length){var e=a[0];e()}},_workFinished:function(){a.length&&(a.shift(),f._processQueue())}};window&&window.addEventListener&&window.addEventListener("message",c,!1);var l=["http://localhost:8081","http://go.goroost.com","https://go.goroost.com","http://cdn.goroost.com","https://cdn.goroost.com"],y=C(function(e){var t=[];for(var n=1;n<e.length;n++)t.push(e[n]);var r=e[0];if(r=="tags"||r=="segments")u.tags=t;else if(r=="segments_add")u.tags?u.tags=u.tags.concat(t):u.tags=t;else if(r=="segments_clear")u.tags&&(u.tags=[]);else if(r=="segments_remove"&&u.tags){for(var i=0;i<t.length;i++){var s=t[i],o=u.tags.indexOf(s);o>-1&&u.tags.splice(o,1)}u.tags=u.tags.concat(t)}f._enqueue(function(){u.rdt?T({url:u.host+"/Ping",vars:{action:r,appKey:u.appkey,tags:JSON.stringify(t),rdt:u.rdt},success:f._workFinished}):f._workFinished()})}),b=C(function(e){var t=null;e&&e.length==2&&(t=e[1]);var n=e[0];n=="alias"?u.alias=t:n=="alias_clear"&&(u.alias=null),f._enqueue(function(){u.rdt?T({url:u.host+"/Ping",vars:{action:e[0],appKey:u.appkey,alias:t,rdt:u.rdt},success:f._workFinished}):f._workFinished()})}),w={appkey:function(){},onload:N,onresult:N,host:N,experimental:N,minvisits:N,tags:y,segments:y,segments_add:y,segments_remove:y,segments_clear:y,alias:b,alias_clear:b,autoprompt:N,prompt:function(){_roost.prompt&&_roost.prompt()},log:function(e){x(e[1])},social_action:C(function(e){T({url:u.host+"/Ping",vars:{action:"socialAction",appKey:u.appkey,useraction:e[1],rdt:L("_rdt")}})}),enable:C(function(e){f._enqueue(function(){T({url:u.host+"/Ping",vars:{action:"enable",appKey:u.appkey,enable:e[1],rdt:u.rdt},success:f._workFinished})})})},A,O=!1,M=function(e){A&&(clearInterval(A),A=null),u.rdt=e.deviceToken,O||(O=!0,_roost._fireRoostCallback({firstTime:!0,deviceToken:e.deviceToken,registered:e.permission!="denied",enabled:!0,tags:_roost._getTags(),alias:_roost._getAlias()})),e.permission=="granted"&&_roost.setCookie("_rdt",e.deviceToken,1825,domain)};H()}(window)